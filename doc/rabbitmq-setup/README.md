### Настройка RabbitMQ

- Создать на сервере RabbitMQ вирутальный хост (можно использовать хост по умолчанию).
- Создать персистентный топик (durable topic) с именем "РИБ.ERP" для центрального узла РИБ.
- Создать персистентный топик (durable topic) с именем "РИБ.АПО" для периферийных узлов РИБ.
- Запустить службу DaJet Agent Service.

Все необходимые очереди для обмена данными на сервере RabbitMQ будут созданы службой
DaJet Agent Service автоматически по, настроенным в файле **appsettings.json**, планам обмена 1С.

Очереди будут иметь имена согласно шаблону: **РИБ.{код узла отправителя}.{код узла получателя}**.

Например, "РИБ.ЦБ.N001" или "РИБ.N002.ЦБ".

Коды узлов будут взяты из указанных планов обмена. Помеченные на удаление узлы учитываться не будут.

Служба автоматически проверяет каждые 10 минут изменение состава узлов планов обмена и добавляет
новые очереди на сервере RabbitMQ в случае необходимости.

Пометка на удаление узлов плана обмена не выполняет автоматического удаления очередей
на сервере RabbitMQ, но они перестают обслуживаться службой. Такие очереди, в случае
необходимости, нужно удалять на сервере RabbitMQ вручную.

![](https://github.com/zhichkin/dajet-agent/blob/main/doc/images/rabbitmq-topics.png)

**P.S.**

Имена топиков в версии 6.3.3 зашиты в код - так сложилось исторически =)

В будущих версиях это будет изменено на получение имён топиков из файлов настроек.